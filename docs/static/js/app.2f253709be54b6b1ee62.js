webpackJsonp([1],{KA74:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("7+uW"),n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var a=s("VU/8")({name:"App"},n,!1,function(t){s("zVHJ")},null,null).exports,o=s("/ocq"),r=s("woOf"),l=s.n(r),c={props:{objData:{type:[Object],default:function(){}}}},u={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"item",class:"level level"+this.objData.level},[e("span",[this._v(this._s(this.objData.title))])])},staticRenderFns:[]};var d=s("VU/8")(c,u,!1,function(t){s("eypN")},null,null).exports,p=s("w/TU"),v=s.n(p),m={props:{title:{type:[String],default:""},cancelBtn:{type:[String],default:""},confirmBtn:{type:[String],default:""},dialogStyle:{type:[String],default:"width: 500px"}},data:function(){return{visable:!1}},methods:{show:function(){this.visable=!0},hide:function(){this.visable=!1},cancel:function(){this.hide()},confirm:function(){this.$emit("confirm"),this.hide()}}},f={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.visable?s("div",{staticClass:"popup"},[s("div",{staticClass:"dialog"},[t.title?s("div",{staticClass:"title"},[t._v(t._s(t.title))]):t._e(),t._v(" "),s("div",{staticClass:"content"},[t._t("default")],2),t._v(" "),s("div",{staticClass:"btn"},[t.cancelBtn?s("button",{on:{click:t.cancel}},[t._v(t._s(t.cancelBtn?t.cancelBtn:"取消"))]):t._e(),t._v(" "),t.confirmBtn?s("button",{on:{click:t.confirm}},[t._v(t._s(t.confirmBtn?t.confirmBtn:"确认"))]):t._e()])])]):t._e()},staticRenderFns:[]};var _=s("VU/8")(m,f,!1,function(t){s("zi/g")},null,null).exports,g={props:{list:{type:[Array]}}},h={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",{staticClass:"c-select"},t._l(t.list,function(e,i){return s("li",{key:i,staticClass:"option",on:{click:function(s){return t.$emit("select",e)}}},[t._v(t._s(e.label))])}),0)},staticRenderFns:[]};var C=s("VU/8")(g,h,!1,function(t){s("lWaK")},null,null).exports,w={props:{listData:{type:[Array],default:function(){return[]}}},components:{ListItem:d,Draggable:v.a,cDialog:_,cSelect:C},data:function(){return{current:"",drag:!1,currentTask:"",groupIndex:"",previewImg:"",listItem:{title:"",description:"",level:0,imgs:[]},showLevelSelect:!1,LEVEL_LIST:[{value:0,label:"普通"},{value:1,label:"紧急"},{value:2,label:"非常紧急"}]}},computed:{dragOptions:function(){return{animation:200,group:"description",disabled:!1,ghostClass:"ghost"}}},filters:{filterLevel:function(t,e){var s="";return e.map(function(e){e.value===+t&&(s=e.label)}),s}},created:function(){var t=this;this.sockets.subscribe("update-task-callback",function(e){console.log("update-task-callback",e),t.$store.commit("M_GET_TASK_GROUP",e)})},methods:{hideSelect:function(){this.showLevelSelect=!1},levelSelect:function(t){this.listItem.level=t.value},clickFileInput:function(){this.$refs.fileInput.dispatchEvent(new MouseEvent("click"))},preview:function(t){this.previewImg=t,this.$refs.previewImg.show()},fileChange:function(t){var e=this,s=t.target.files[0];console.log(s);var i=new FileReader;i.readAsDataURL(s),i.onload=function(t){console.log(i.result),e.listItem.imgs.push(i.result)}},touchStart:function(t){console.log(t)},endDrag:function(){this.drag=!1,this.$socket.emit("update-task",{group_id:this.current,item:this.currentTask}),this.current=""},itemDetailConfirm:function(){this.$store.dispatch("A_CREATED_TASK",{group_id:this.groupIndex,item:this.listItem})},editListItem:function(t){this.listItem=l()({imgs:[]},t),this.groupIndex=t.group_id,this.$refs.itemDetail.show()},addItem:function(t){this.groupIndex=t,this.listItem={title:"",description:"",level:0,imgs:[]},this.$refs.itemDetail.show()},onMoveCallback:function(t,e){this.currentTask=t.draggedContext.element,this.current=+t.to.dataset.index}}},T={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"section"},[s("div",{staticClass:"clearfix",attrs:{id:"list"}},t._l(t.listData,function(e,i){return s("div",{key:i,staticClass:"list-group"},[s("div",{staticClass:"list-title"},[t._v(t._s(e.group_title)+"\n        "),s("span",{staticClass:"add-item",on:{click:function(s){return t.addItem(e.group_id)}}},[t._v("+")])]),t._v(" "),s("draggable",t._b({staticClass:"draggable",class:{active:t.current===e.group_id},attrs:{"data-index":e.group_id,move:t.onMoveCallback,list:e.list,group:"people",name:t.drag?null:"flip-list"},on:{end:t.endDrag,start:function(e){t.drag=!0}}},"draggable",t.dragOptions,!1),t._l(e.list,function(e){return s("div",{key:e.id,staticClass:"draggable-item",attrs:{"data-item":e},on:{click:function(s){return t.editListItem(e)}}},[s("list-item",{attrs:{objData:e}})],1)}),0)],1)}),0),t._v(" "),s("c-dialog",{ref:"itemDetail",staticClass:"item-detail",attrs:{title:t.listItem.id?"编辑":"新增",cancelBtn:"取消",confirmBtn:"确认"},on:{confirm:t.itemDetailConfirm}},[s("div",[s("ul",[s("li",{staticClass:"dis-flex"},[s("div",{staticClass:"w-80"},[t._v("概要")]),t._v(" "),s("div",{staticClass:"flex1"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.listItem.title,expression:"listItem.title"}],attrs:{type:"text"},domProps:{value:t.listItem.title},on:{input:function(e){e.target.composing||t.$set(t.listItem,"title",e.target.value)}}})])]),t._v(" "),s("li",{staticClass:"dis-flex"},[s("div",{staticClass:"w-80"},[t._v("描述")]),t._v(" "),s("div",{staticClass:"flex1"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.listItem.description,expression:"listItem.description"}],attrs:{id:"",cols:"30",rows:"10"},domProps:{value:t.listItem.description},on:{input:function(e){e.target.composing||t.$set(t.listItem,"description",e.target.value)}}})])]),t._v(" "),s("li",{staticClass:"dis-flex"},[s("div",{staticClass:"w-80"},[t._v("附件")]),t._v(" "),s("div",{staticClass:"flex1"},[t._l(t.listItem.imgs,function(e,i){return s("img",{key:i,staticClass:"img-pre",attrs:{src:e},on:{click:function(s){return t.preview(e)}}})}),t._v(" "),s("div",{staticClass:"add-img-btn",on:{click:t.clickFileInput}},[s("i",{staticClass:"iconfont"},[t._v("")])]),t._v(" "),s("input",{ref:"fileInput",staticClass:"file-input",attrs:{type:"file"},on:{change:t.fileChange}})],2)]),t._v(" "),s("li",{staticClass:"dis-flex"},[s("div",{staticClass:"w-80"},[t._v("优先级")]),t._v(" "),s("div",{staticClass:"flex1 relative"},[s("input",{directives:[{name:"click-out",rawName:"v-click-out",value:t.hideSelect,expression:"hideSelect"}],attrs:{type:"text",readonly:""},domProps:{value:t._f("filterLevel")(t.listItem.level,t.LEVEL_LIST)},on:{click:function(e){t.showLevelSelect=!0}}}),t._v(" "),t.showLevelSelect?s("c-select",{attrs:{list:t.LEVEL_LIST},on:{select:t.levelSelect}}):t._e()],1)])])])]),t._v(" "),s("c-dialog",{ref:"previewImg",staticClass:"preview-img",attrs:{title:"",cancelBtn:"",confirmBtn:""}},[s("div",[s("img",{staticClass:"img-pre",attrs:{src:t.previewImg}})]),t._v(" "),s("i",{staticClass:"close iconfont",on:{click:function(e){return t.$refs.previewImg.hide()}}},[t._v("")])])],1)},staticRenderFns:[]};var k=s("VU/8")(w,T,!1,function(t){s("xM5S")},null,null).exports,b=s("NYxO"),x={data:function(){return{groupName:"",showFunc:!0}},computed:Object(b.b)({todoData:function(t){return t.todoData}}),created:function(){this.$store.dispatch("A_GET_TASK_GROUP")},methods:{test:function(){this.showFunc=!1},confirmCreateGroup:function(){var t=this;this.$store.dispatch("A_CREATE_TASK_GROUP",{group_title:this.groupName,list:[]}).then(function(){t.$store.dispatch("A_GET_TASK_GROUP")})}},components:{List:k,cDialog:_}},I={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"todo-content"},[s("div",{staticClass:"func-menu",class:{mode:!t.showFunc}},[s("div",{directives:[{name:"click-out",rawName:"v-click-out",value:t.test,expression:"test"}],staticClass:"li",on:{click:function(e){t.showFunc=!0}}},[s("i",{staticClass:"iconfont"},[t._v("")])]),t._v(" "),s("div",{staticClass:"li",on:{click:function(e){return t.$refs.createGroupDialog.show()}}},[s("i",{staticClass:"iconfont"},[t._v("")]),t._v(" "),1==t.showFunc?s("span",[t._v("新建分组")]):t._e()]),t._v(" "),s("div",{staticClass:"li"},[s("i",{staticClass:"iconfont"},[t._v("")]),t._v(" "),1==t.showFunc?s("span",[t._v("系统消息")]):t._e()]),t._v(" "),s("div",{staticClass:"li"},[s("i",{staticClass:"iconfont"},[t._v("")]),t._v(" "),1==t.showFunc?s("span",[t._v("用户设置")]):t._e()])]),t._v(" "),s("list",{attrs:{listData:t.todoData}}),t._v(" "),s("c-dialog",{ref:"createGroupDialog",staticClass:"new-group",attrs:{title:"新建任务",cancelBtn:"取消",confirmBtn:"确认"},on:{confirm:t.confirmCreateGroup}},[s("div",[s("ul",[s("li",{staticClass:"dis-flex"},[s("div",{staticClass:"w-80"},[t._v("分组名称")]),t._v(" "),s("div",{staticClass:"flex1"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.groupName,expression:"groupName"}],attrs:{type:"text"},domProps:{value:t.groupName},on:{input:function(e){e.target.composing||(t.groupName=e.target.value)}}})])])])])])],1)},staticRenderFns:[]},S=s("VU/8")(x,I,!1,null,null,null).exports,A={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"user"}},[e("router-view")],1)},staticRenderFns:[]},E=s("VU/8")(null,A,!1,null,null,null).exports,L={data:function(){return{type:this.$route.name,username:"",password:"",password2:""}},methods:{login:function(){var t=this;t.$store.dispatch("A_LOGIN",{username:t.username,password:t.password}).then(function(e){t.$router.push({name:"TodoList"})},function(t){console.log(t)})},register:function(){var t=this;t.$store.dispatch("A_REGISTER",{username:t.username,password:t.password,password2:t.password2}).then(function(){t.$router.push({name:"Login",query:{type:1}})})}}},O={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"user-login-register"}},["Login"==t.type?s("div",{attrs:{id:"login"}},[s("div",{staticClass:"form"},[s("h1",[t._v("用户登录")]),t._v(" "),s("div",{staticClass:"c-input"},[s("label",{attrs:{for:""}},[t._v("用户名")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],attrs:{type:"text",placeholder:"请输入用户名"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"c-input"},[s("label",{attrs:{for:""}},[t._v("密码")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",placeholder:"请输入密码"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"c-input"},[s("label",{attrs:{for:""}},[t._v(" ")]),t._v(" "),s("input",{staticClass:"btn",attrs:{type:"button",value:"登录"},on:{click:t.login}})])])]):s("div",{attrs:{id:"register"}},[s("div",{staticClass:"form"},[s("h1",[t._v("用户注册")]),t._v(" "),s("div",{staticClass:"c-input"},[s("label",{attrs:{for:""}},[t._v("用户名")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],attrs:{type:"text",placeholder:"请输入用户名"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"c-input"},[s("label",{attrs:{for:""}},[t._v("密码")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",placeholder:"请输入密码"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"c-input"},[s("label",{attrs:{for:""}},[t._v("重复密码")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.password2,expression:"password2"}],attrs:{type:"password",placeholder:"再次输入密码"},domProps:{value:t.password2},on:{input:function(e){e.target.composing||(t.password2=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"c-input"},[s("label",{attrs:{for:""}},[t._v(" ")]),t._v(" "),s("input",{staticClass:"btn",attrs:{type:"button",value:"注册"},on:{click:t.register}})])])])])},staticRenderFns:[]};var D=s("VU/8")(L,O,!1,function(t){s("KA74")},null,null).exports;i.a.use(o.a);var y=new o.a({mode:"history",routes:[{path:"/",name:"TodoList",component:S},{path:"/user/login",name:"Login",component:D},{path:"/user",name:"User",component:E,children:[{path:"/user/login",name:"Login",component:D},{path:"/user/register",name:"Register",component:D}]}]}),R=s("bOdI"),$=s.n(R),G=s("//Fk"),P=s.n(G),U=s("mtWM"),N=s.n(U).a.create({baseURL:"/api",headers:{"Content-Type":"application/json; charset=UTF-8"},timeout:6e4});N.interceptors.request.use(function(t){var e=t.headers=t.headers||{},s=localStorage.getItem("x-token");return e["x-token"]=s,t.json&&(e["Content-Type"]="application/json; charset=UTF-8",delete t.json),t},function(t){return P.a.reject(t)}),N.interceptors.response.use(function(t){return t.headers["x-token"]&&localStorage.setItem("x-token",t.headers["x-token"]),t},function(t){switch(t.response.data.code){case 1e3:location.href="/user/login?type=1"}return P.a.reject(t)});var F,j,K=N,B=(F={},$()(F,"A_REGISTER",function(t,e){t.commit,t.dispatch;K({method:"POST",url:"/user/register",json:!0,data:e}).then(function(){})}),$()(F,"A_LOGIN",function(t,e){t.commit,t.dispatch;return K({method:"POST",url:"/user/login",json:!0,data:e}).then(function(t){return P.a.resolve(t)},function(t){return P.a.reject(t)})}),$()(F,"A_CREATED_TASK",function(t,e){t.commit;var s=t.dispatch;K({method:"POST",url:"/task/update-task",json:!0,data:e}).then(function(){s("A_GET_TASK_GROUP")})}),$()(F,"A_CREATE_TASK_GROUP",function(t,e){var s=t.commit;K({method:"POST",url:"/task/create-task-group",json:!0,data:e}).then(function(){s("M_CREATE_TASK_GROUP",e)})}),$()(F,"A_GET_TASK_GROUP",function(t,e){var s=t.commit;K({method:"GET",url:"/task/get-task-list",json:!0,data:e}).then(function(t){var e=t.data;s("M_GET_TASK_GROUP",e)})}),F),M=s("Eb2/"),V=s.n(M),H={set setTodoList(t){t?V.a.set("TODO_LIST_DATA",t):V.a.remove("TODO_LIST_DATA")},get getTodoList(){return V.a.get("TODO_LIST_DATA")}},z=(j={},$()(j,"M_GET_TASK_GROUP",function(t,e){var s={},i=[];e.map(function(t){var e=t.group_id;(i=s[e]||[]).push(t),s[e]=i});var n=[];for(var a in s)n.push({group_id:a,group_title:s[a][0].g_title,list:s[a].filter(function(t){return t.id})});t.todoData=n,H.setTodoList=t.todoData}),$()(j,"M_CREATE_TASK_GROUP",function(t,e){t.todoData.push(e),H.setTodoList=t.todoData}),$()(j,"M_CREATE_TODO_LIST_GROUP",function(t,e){t.todoData.push(e),H.setTodoList=t.todoData}),j),W={};i.a.use(b.a);var q={todoData:H.getTodoList||[{title:"待处理",list:[]},{title:"进行中",list:[]},{title:"已完成",list:[]}]},J=new b.a.Store({state:q,mutations:z,actions:B,getters:W}),Y={clickOut:{bind:function(t,e,s){function i(s){if(t.contains(s.target))return!1;e.expression&&e.value(s)}t.__vueClickOutside__=i,document.addEventListener("click",i)},update:function(){},unbind:function(t,e){document.removeEventListener("click",t.__vueClickOutside__),delete t.__vueClickOutside__}}},Q=s("HI0L"),X=s.n(Q);i.a.config.productionTip=!1,i.a.directive("clickOut",Y.clickOut),i.a.use(new X.a({debug:!0,connection:"http://localhost:3000"})),new i.a({el:"#app",router:y,store:J,components:{App:a},template:"<App/>"})},eypN:function(t,e){},lWaK:function(t,e){},xM5S:function(t,e){},zVHJ:function(t,e){},"zi/g":function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.2f253709be54b6b1ee62.js.map